---
 title: "Hands-on with CVE-2025-22442, a work profile sideloading vulnerability affecting most Android devices today"
 date: '2025-04-11'
 status: publish
 author: 'Jason Bayton'
 excerpt: "CVE-2025-22442 is a gnarly one, but how worried should organisations be?"
 type: post
 tags:
     - Enterprise
---

I happened upon a [Medium article by Bastien Bobe](https://medium.com/@threatspotlight/how-to-exploit-cve-2025-22442-to-install-an-apk-in-an-android-work-profile-ee8d5345f841), field CTO at Lookout, this week. His article gave me a good overview of a vulnerability discovered by Alan Zaccardelle that I'd previously not heard about.

I'd encourage reading the linked article above for the overview and demo video of the vulnerability, but in a nutshell the issue is as follows:

During work profile setup, there's a temporary state as the profile initialises where _no policies are applied_. It's too early for organisational policy to enforce (in which sideloading is always prevented by default) and there's no default policy in place on Google's side. 

The work profile is wide open.

This means if a user has developer settings enabled, USB debugging turned on, and the device connected up to their computer, a script can be written to check for the presence of the work profile, and immediately `adb install package.apk` as many apps as desired until continuing on to the point of registration/enrolment and corporate policy application.

Here's a video of my own tinkering (I don't pause the process, so policy can be seen blocking further installs), and I'll continue the article below:

https://youtu.be/cw8i-vd0CiE

## What versions of Android are in scope?

Pretty much all Android versions going back 10+ years. 

Android 16 beta 3 is already patched, so 16 will be the first release in recent times to launch without it. For Android 12-15, a patch has been provided in April's SPL. Everything prior to that is for the respective OEMs to find and fix themselves (though running Android 11 or earlier today comes with many more risks than just this, if not manually maintained by the OEM).

## What are the ramifications?

The clear risk is the presence of unauthorised applications in the work profile, and the potential for data leakage through them. The entire point of the work profile is to isolate corporate apps and data in a separately encrypted and siloed environment; allowing unauthorised applications can effectively bridge the cross-profile divide, and this is quite obviously bad.

Unlike Bastien's take, I'm less concerned about malicious, or Potentially Harmful Applications (PHAs) being a risk, as despite his claim, [Google Play Protect](https://developers.google.com/android/play-protect/client-protections) scans over 200 billion applications a day across Android devices globally, including at-least daily checks for known bad applications, and real-time checks of non-Google Play installed applications.

So this: 

> By design, MDM won’t be able to detect malicious or unwanted apps in the work profile

Is misleading. While MDM isn't necessarily the on-device engine scanning apps (that is GPP), Android's built-in protections work well with, and are enforced by, MDM. Of course vendors like Ivanti also have MTD built in, in which case the MDM _will_ be able to detect these apps directly, in addition to GPP.

Suggesting unwanted apps can run amok on the other hand is a fair claim.

## What can organisations do to protect themselves?

It just so happens if your EMM leverages the Android Management API and _is not Intune_, you don't have to do anything. Within a few minutes, as shown by my video above, AMAPI removes any unauthorised applications; arguably before these apps could really get much - if any - data.

### Why not Intune?

Microsoft uses Company Portal with work profile devices instead of AMAPI's Android Device Policy, and Microsoft, of course, seems to have not implemented the AMAPI behaviour that automatically removes unauthorised apps. As such, devices are susceptible in AMAPI when using Intune also. 

### What about non-AMAPI platforms?

If you're an Omnissa (Airwatch/WS1), SOTI or Ivanti (MobileIron) house, or other custom DPC platform, organisations have to be vigilant; keeping tabs on installed applications for work profile devices and locating outliers as they may appear.

Although Bastien says: 

> If you don’t have an MTD application deployed in your work profile, you won’t see anything and the malicious user can exfiltrate data for years…

This is also misleading. MTD will make things exponentially easier/faster to detect anomalies, but many MDMs show installed applications within application inventories synced from devices. While there may be gaps in this capability across the ecosystem, it's a common feature. 

While this CVE is active across an estate, taking the time to pour through application inventories synced up could save a lot of hassle later on. This could potentially even be done via automated reports and some basic scripting.

Other things you can do? 

**Make sure Google Play Protect is enforced.**
: It'll be enabled, but users will have the ability to adjust settings if not enforced. You can fix that. 

**Build blocklists of known troublesome apps**
: Magisk, SMS Backup & Restore, Dropbox, Seal, etc, etc - build out your lists of known apps to block, and if a user tries to sideload, these will be removed even if the platform isn't AMAPI.

**Prevent installation from unknown sources**
: That won't _technically_ help to prevent this, but protects an organisation against threats generally. See [Why you shouldn't install apps from unknown sources](https://bayton.org/android/why-you-shouldnt-install-apps-from-unknown-sources/).

### Or invest in an MTD

The linked article is obviously very heavily biased towards the benefits of MTD, but speaking without bias, I'm all for additional security on mobile devices providing the solution isn't just a glorified antivirus, as these are generally ineffective in Android - doing little, if anything, more than Google Play Protect. 

A full-featured MTD can help monitor not only applications, but network traffic, help prevent phishing/smishing) and much more. And for what it's worth, I think Lookout is a great option for this.

[Here are some considerations](/android/mtd-and-android-enterprise/) I've written previously that should still be relevant.

## Has this affected you?

I'd very much like to understand the potential impact this CVE has had, or will have, now that it's public and not universally patched. Are you seeing applications showing up in reports you don't expect? How are you handling it?

Get in touch, if desired!